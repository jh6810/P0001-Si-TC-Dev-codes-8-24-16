
units 		metal
dimension	3
boundary	p	p	p
atom_style	atomic

##load structure
read_data lammps_data.0K.minimized
  orthogonal box = (-1.07737 -5.38687 -1.07737) to (26.0774 130.387 26.0774)
  1 by 8 by 1 MPI processor grid
  reading atoms ...
  5000 atoms
  reading velocities ...
  5000 velocities

##scale block and randomize velocities
print ${ave_SF}
print 1.00194017060324
1.00194017060324

change_box all x scale ${ave_SF} y scale ${ave_SF} z scale ${ave_SF} remap
change_box all x scale 1.00194017060324 y scale ${ave_SF} z scale ${ave_SF} remap
change_box all x scale 1.00194017060324 y scale 1.00194017060324 z scale ${ave_SF} remap
change_box all x scale 1.00194017060324 y scale 1.00194017060324 z scale 1.00194017060324 remap
  orthogonal box = (-1.10372 -5.38687 -1.07737) to (26.1037 130.387 26.0774)
  orthogonal box = (-1.10372 -5.51858 -1.07737) to (26.1037 130.519 26.0774)
  orthogonal box = (-1.10372 -5.51858 -1.10372) to (26.1037 130.519 26.1037)
velocity all create ${T} 4928459 rot yes mom yes dist gaussian
velocity all create 500 4928459 rot yes mom yes dist gaussian

#load potential
pair_style sw
pair_coeff * * pot/Si.sw Si
Reading potential file pot/Si.sw with DATE: 2007-06-11
mass * 28.0855

thermo ${thermo_save}
thermo 1000
thermo_style custom time temp press
fix 1 all nvt temp ${T} ${T} 0.1
fix 1 all nvt temp 500 ${T} 0.1
fix 1 all nvt temp 500 500 0.1

##EQ RUN
run ${N_EQ}
run 7500
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.77118
  ghost atom cutoff = 5.77118
  binsize = 2.88559 -> bins = 10 48 10
Memory usage per processor = 2.40356 Mbytes
Time Temp Press 
           0          500   -2420.7399 
           1    525.87045    216.08784 
           2    498.50695   -55.272513 
           3    488.72896    -234.9569 
           4    496.15434    9.4936953 
           5    492.82108   -94.745382 
           6    514.88478    118.82813 
           7    491.98971    -127.0874 
         7.5    504.11878   -8.1293152 
Loop time of 27.9052 on 8 procs for 7500 steps with 5000 atoms

Performance: 23.221 ns/day, 1.034 hours/ns, 268.767 timesteps/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 22.662     | 24.054     | 25.526     |  21.4 | 86.20
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.40576    | 2.0942     | 3.9088     |  85.0 |  7.50
Output  | 0.00018382 | 0.00020701 | 0.00029039 |   0.2 |  0.00
Modify  | 1.1023     | 1.6585     | 2.0921     |  21.8 |  5.94
Other   |            | 0.09812    |            |       |  0.35

Nlocal:    625 ave 650 max 600 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Nghost:    1585.25 ave 1618 max 1553 min
Histogram: 2 0 2 0 0 0 0 2 0 2
Neighs:    0 ave 0 max 0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:  21250 ave 22100 max 20400 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 170000
Ave neighs/atom = 34
Neighbor list builds = 0
Dangerous builds = 0
#log output-2/log.TC.${T}  #save TD output to this file

##PROD RUN (just to check the average pressure)
reset_timestep 0

variable Pxx equal pxx*0.0001 #GPa
variable Pyy equal pyy*0.0001 #GPa
variable Pzz equal pzz*0.0001 #GPa
variable Pxy equal pxy*0.0001 #GPa
variable Pxz equal pxz*0.0001 #GPa
variable Pyz equal pyz*0.0001 #GPa

##Nevery=2, Nrepeat=6, and Nfreq=100, then values on timesteps 90,92,94,96,98,100
fix ave_press all ave/time 1 ${N_PROD_NVT} ${N_PROD_NVT} v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file  ${LOC1}/NVT-ave-pressure-5-25.dat
fix ave_press all ave/time 1 2000 ${N_PROD_NVT} v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file  ${LOC1}/NVT-ave-pressure-5-25.dat
fix ave_press all ave/time 1 2000 2000 v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file  ${LOC1}/NVT-ave-pressure-5-25.dat
fix ave_press all ave/time 1 2000 2000 v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file  ../output/output-1//NVT-ave-pressure-5-25.dat

run ${N_PROD_NVT}
run 2000
Memory usage per processor = 2.40356 Mbytes
Time Temp Press 
         7.5    504.11878   -8.1293152 
         8.5    501.01683    94.694099 
         9.5    505.62846    15.233309 
Loop time of 7.8766 on 8 procs for 2000 steps with 5000 atoms

Performance: 21.938 ns/day, 1.094 hours/ns, 253.917 timesteps/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.2592     | 6.6605     | 7.3821     |  12.6 | 84.56
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.15385    | 0.56545    | 1.1417     |  42.1 |  7.18
Output  | 8.6308e-05 | 9.4265e-05 | 0.00013709 |   0.2 |  0.00
Modify  | 0.19711    | 0.61905    | 1.0344     |  40.4 |  7.86
Other   |            | 0.03153    |            |       |  0.40

Nlocal:    625 ave 639 max 611 min
Histogram: 2 1 0 1 0 0 1 0 1 2
Nghost:    1585.25 ave 1604 max 1564 min
Histogram: 1 0 1 0 3 0 0 1 0 2
Neighs:    0 ave 0 max 0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:  21724 ave 22304 max 21174 min
Histogram: 1 2 0 1 0 1 0 1 1 1

Total # of neighbors = 173792
Ave neighs/atom = 34.7584
Neighbor list builds = 0
Dangerous builds = 0

write_data ${LOC1}/NVT-EQ-STRUCTURE-5-25 #data file
write_data ../output/output-1//NVT-EQ-STRUCTURE-5-25 

clear

####--------------------------------------------------------------------
####SIMULATION-4: RUN NVE AND APPLY MULLER-PLATHE TO GET THERMAL CONDUCTIVITY
####--------------------------------------------------------------------

log ${LOC2}/log-TC-eq-5-25  #save TD output to this file
log ../output/output-2//log-TC-eq-5-25  
