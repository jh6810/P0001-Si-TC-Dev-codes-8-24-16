
variable Pxx equal pxx*0.0001 #GPa
variable Pyy equal pyy*0.0001 #GPa
variable Pzz equal pzz*0.0001 #GPa
variable Pxy equal pxy*0.0001 #GPa
variable Pxz equal pxz*0.0001 #GPa
variable Pyz equal pyz*0.0001 #GPa

##Nevery=2, Nrepeat=6, and Nfreq=100, then values on timesteps 90,92,94,96,98,100
fix ave_press all ave/time 1 ${N_PROD_NVT} ${N_PROD_NVT} v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file output-1/NVT-ave-pressure.dat
fix ave_press all ave/time 1 5000 ${N_PROD_NVT} v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file output-1/NVT-ave-pressure.dat
fix ave_press all ave/time 1 5000 5000 v_Pxx v_Pyy v_Pzz v_Pxy v_Pxz v_Pyz  file output-1/NVT-ave-pressure.dat
run ${N_PROD_NVT}
run 5000
Memory usage per processor = 2.51802 Mbytes
Time Temp Press 
         2.5     469.6527   -118.34794 
           3    457.00353   -396.79523 
         3.5    492.64918    164.93782 
           4    520.38866    280.03403 
         4.5    494.34053   -221.81963 
           5    468.94823    -246.6085 
         5.5    512.26901   -71.215278 
           6    513.46858    52.206763 
         6.5    513.41025    151.12646 
           7    490.68762   -235.55658 
         7.5    491.33509   -242.01651 
Loop time of 7.60185 on 8 procs for 5000 steps with 2000 atoms

Performance: 56.828 ns/day, 0.422 hours/ns, 657.735 timesteps/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.3017     | 6.522      | 6.7381     |   5.3 | 85.80
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.62038    | 0.83896    | 1.0581     |  14.8 | 11.04
Output  | 0.0002811  | 0.00030327 | 0.00042582 |   0.3 |  0.00
Modify  | 0.18706    | 0.19171    | 0.19662    |   0.6 |  2.52
Other   |            | 0.04885    |            |       |  0.64

Nlocal:    250 ave 257 max 242 min
Histogram: 1 0 2 0 0 0 2 0 2 1
Nghost:    1066.5 ave 1074 max 1059 min
Histogram: 1 0 2 1 1 0 0 0 2 1
Neighs:    0 ave 0 max 0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:  8694.75 ave 8941 max 8374 min
Histogram: 1 0 2 0 0 0 1 2 0 2

Total # of neighbors = 69558
Ave neighs/atom = 34.779
Neighbor list builds = 0
Dangerous builds = 0

write_data output-1/NVT-EQ-STRUCTURE.${T}K #data file
write_data output-1/NVT-EQ-STRUCTURE.500K 

clear

###--------------------------------------------------------------------
###SIMULATION-4: RUN NVE AND APPLY MULLER-PLATHE TO GET THERMAL CONDUCTIVITY
###--------------------------------------------------------------------

#units 		metal
#dimension	3
#boundary	p	p	p
#atom_style	atomic

###READ ATOMS
#read_data output-1/NVT-EQ-STRUCTURE.${T}K
#velocity all create ${T} 4928459 rot yes mom yes dist gaussian

###load potential
#pair_style sw
#pair_coeff * * pot/Si.sw Si
#mass * 28.0855


##LET THE FIX EQUILIBIRATE
####fix ID group-ID thermal/conductivity N edim Nbin keyword value ...
#fix 1 all thermal/conductivity 100 y 20 swap 1
#fix       2 all nve
#compute   KE all ke/atom
#variable  temp1 atom c_KE/(1.5*0.00008617)
#compute   layers all chunk/atom bin/1d y lower 2.0 #units reduced
#fix       3 all ave/chunk 1  1000 1000   layers v_temp1 file output-2/tmp.profile
#thermo ${thermo_save}
#variable A equal lx*lz
#variable flux equal f_1/((time-0.000000001)*v_A) #ADD -0.000001 to avoid division by zero
#thermo_style custom time temp vol v_A f_1 v_flux
#run ${N_TC_EQ}
#write_data output-2/TC-EQ.${T}K #data file
#clear

###--------------------------------------------------------------------
###SIMULATION-4: RUN NVE AND APPLY MULLER-PLATHE TO GET THERMAL CONDUCTIVITY
###--------------------------------------------------------------------

units 		metal
dimension	3
boundary	p	p	p
atom_style	atomic

##READ ATOMS
#read_data output-2/TC-EQ.${T}K
read_data output-1/NVT-EQ-STRUCTURE.${T}K
read_data output-1/NVT-EQ-STRUCTURE.500K
  orthogonal box = (-1.10351 -2.20701 -1.10351) to (26.1035 52.207 26.1035)
  1 by 4 by 2 MPI processor grid
  reading atoms ...
  2000 atoms
  reading velocities ...
  2000 velocities
velocity all create ${T} 4928459 rot yes mom yes dist gaussian
velocity all create 500 4928459 rot yes mom yes dist gaussian


##load potential
pair_style sw
pair_coeff * * pot/Si.sw Si
Reading potential file pot/Si.sw with DATE: 2007-06-11
mass * 28.0855

#LET THE FIX EQUILIBIRATE
###fix ID group-ID thermal/conductivity N edim Nbin keyword value ...
fix 1 all thermal/conductivity 100 y 20 swap 1
fix       2 all nve
compute   KE all ke/atom
variable  temp1 atom c_KE/(1.5*0.00008617)
compute   layers all chunk/atom bin/1d y lower 2.0 #units reduced
fix       3 all ave/chunk 1  ${N_TC}   ${N_TC}   layers v_temp1 file output-2/tmp2.profile
fix       3 all ave/chunk 1  50000   ${N_TC}   layers v_temp1 file output-2/tmp2.profile
fix       3 all ave/chunk 1  50000   50000   layers v_temp1 file output-2/tmp2.profile
thermo ${thermo_save}
thermo 500
variable A equal lx*lz
variable flux equal f_1/((time-0.000000000001)*v_A) #ADD -0.000001 to avoid division by zero
thermo_style custom time temp vol v_A f_1 v_flux


run ${N_TC}
run 50000
Neighbor list info ...
  1 neighbor list requests
  update every 1 steps, delay 10 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 5.77118
  ghost atom cutoff = 5.77118
  binsize = 2.88559 -> bins = 10 19 10
Memory usage per processor = 2.64695 Mbytes
Time Temp Volume A 1 flux 
           0          500    40278.431    740.22151            0           -0 
         0.5    497.45523    40278.431    740.22151     1.266078 0.0034208083 
           1    469.80978    40278.431    740.22151    2.6170173 0.0035354516 
         1.5    498.25131    40278.431    740.22151    3.7700362 0.0033954126 
           2     499.7968    40278.431    740.22151    5.1569896 0.0034834098 
         2.5    492.11094    40278.431    740.22151    6.4124614 0.0034651581 
           3    469.58017    40278.431    740.22151    7.7338235 0.0034826618 
         3.5    490.21951    40278.431    740.22151     9.169578 0.0035393182 
           4    497.37206    40278.431    740.22151    10.517535 0.0035521579 
         4.5    488.39877    40278.431    740.22151    11.876712 0.0035655129 
           5    495.43141    40278.431    740.22151     13.02771 0.0035199491 
         5.5    489.98633    40278.431    740.22151    14.417337 0.0035412832 
           6    504.96968    40278.431    740.22151    16.130519 0.0036319127 
         6.5    487.96314    40278.431    740.22151    17.620465 0.0036622022 
           7    508.25415    40278.431    740.22151    18.825344 0.0036331488 
         7.5    534.93955    40278.431    740.22151    20.429583 0.0036799044 
           8    499.82241    40278.431    740.22151    21.722118 0.0036681787 
         8.5    511.56474    40278.431    740.22151    22.958853 0.0036489639 
           9    485.32392    40278.431    740.22151     24.02068 0.0036056294 
         9.5    482.85907    40278.431    740.22151    25.337225 0.0036030786 
          10    492.68414    40278.431    740.22151     26.61403 0.0035954144 
        10.5    501.08665    40278.431    740.22151     28.15241 0.0036221346 
          11     492.5347    40278.431    740.22151    29.454044 0.0036173501 
        11.5    499.86246    40278.431    740.22151     30.63458 0.0035987559 
          12    497.78197    40278.431    740.22151    32.167396 0.0036213705 
        12.5    499.32443    40278.431    740.22151     33.34434 0.0036037147 
          13    501.34412    40278.431    740.22151    34.533175 0.0035886529 
        13.5    482.86999    40278.431    740.22151    35.617845  0.003564283 
          14    493.50179    40278.431    740.22151    37.027406 0.0035730044 
        14.5    488.24215    40278.431    740.22151    38.299674  0.003568333 
          15    492.12686    40278.431    740.22151    39.496733 0.0035571994 
        15.5    494.98452    40278.431    740.22151    40.792481 0.0035553857 
          16    494.97102    40278.431    740.22151    41.870663 0.0035353153 
        16.5    507.86876    40278.431    740.22151      43.3921 0.0035527531 
          17    487.78219    40278.431    740.22151    44.660266 0.0035490383 
        17.5    502.91956    40278.431    740.22151    46.170629 0.0035642326 
          18    506.72384    40278.431    740.22151    47.527622  0.003567072 
        18.5    512.75159    40278.431    740.22151    48.925794  0.003572765 
          19    497.64055    40278.431    740.22151    50.351667  0.003580128 
        19.5    506.49137    40278.431    740.22151    51.529763 0.0035699475 
          20    505.42127    40278.431    740.22151    52.682398 0.0035585563 
        20.5    492.71411    40278.431    740.22151    53.871466 0.0035501216 
          21    502.85572    40278.431    740.22151    55.098357 0.0035445218 
        21.5     493.1444    40278.431    740.22151    56.486313 0.0035493029 
          22    503.66513    40278.431    740.22151    57.668674 0.0035412418 
        22.5    488.96717    40278.431    740.22151    59.079267 0.0035472425 
          23     482.0673    40278.431    740.22151     60.31301 0.0035425947 
        23.5    487.34731    40278.431    740.22151    61.662479 0.0035447974 
          24    499.43592    40278.431    740.22151     62.95367 0.0035436279 
        24.5    494.99633    40278.431    740.22151    64.144303 0.0035369613 
          25    491.92725    40278.431    740.22151    65.274935  0.003527319 
        25.5     500.7769    40278.431    740.22151    66.443775 0.0035200791 
          26    496.68669    40278.431    740.22151    68.065621 0.0035366556 
        26.5    497.20115    40278.431    740.22151    69.507683 0.0035434413 
          27    495.57166    40278.431    740.22151    71.136518 0.0035593209 
        27.5    492.05056    40278.431    740.22151    72.364548 0.0035549333 
          28     508.7144    40278.431    740.22151    73.791038 0.0035602778 
        28.5    508.49051    40278.431    740.22151    75.155099 0.0035624755 
          29    492.45514    40278.431    740.22151    76.246889 0.0035519139 
        29.5    493.09336    40278.431    740.22151    77.414923 0.0035452019 
          30    497.83113    40278.431    740.22151    78.446885 0.0035325861 
        30.5    502.31351    40278.431    740.22151    79.694957 0.0035299561 
          31    508.75967    40278.431    740.22151    81.002297 0.0035299938 
        31.5    503.57019    40278.431    740.22151    82.148169 0.0035231054 
          32     503.4969    40278.431    740.22151    83.410224 0.0035213372 
        32.5     507.0825    40278.431    740.22151    84.604974 0.0035168256 
          33    490.46101    40278.431    740.22151      85.8397 0.0035140873 
        33.5    499.19936    40278.431    740.22151    87.042678 0.0035101505 
          34     492.3798    40278.431    740.22151    88.480808 0.0035156729 
        34.5    491.14546    40278.431    740.22151    89.846075 0.0035181821 
          35    486.59219    40278.431    740.22151    91.156141 0.0035184889 
        35.5    498.80823    40278.431    740.22151    92.407615 0.0035165574 
          36    491.42749    40278.431    740.22151    93.703622 0.0035163507 
        36.5    495.01794    40278.431    740.22151    94.802151 0.0035088405 
          37    496.19639    40278.431    740.22151    95.861564 0.0035001051 
        37.5    492.28569    40278.431    740.22151    96.914577 0.0034913721 
          38    498.91216    40278.431    740.22151    98.267078 0.0034935161 
        38.5    489.41047    40278.431    740.22151    99.525699 0.0034923102 
          39    485.46832    40278.431    740.22151    100.52671 0.0034822117 
        39.5    501.16254    40278.431    740.22151    101.73291 0.0034793866 
          40    508.94609    40278.431    740.22151    103.07958  0.003481376 
        40.5      509.037    40278.431    740.22151    104.37069 0.0034814633 
          41    494.83255    40278.431    740.22151    105.65058 0.0034811789 
        41.5    494.90797    40278.431    740.22151    106.85302 0.0034783798 
          42    497.57296    40278.431    740.22151    108.08708 0.0034766646 
        42.5    496.05244    40278.431    740.22151    109.10549 0.0034681348 
          43     490.2515    40278.431    740.22151    110.30131 0.0034653771 
        43.5    499.95064    40278.431    740.22151    111.42302 0.0034603815 
          44     498.0761    40278.431    740.22151    112.55434 0.0034557943 
        44.5    499.43608    40278.431    740.22151    113.82092 0.0034554164 
          45      503.594    40278.431    740.22151    115.25894 0.0034601938 
        45.5    504.41065    40278.431    740.22151    116.70468 0.0034650952 
          46    508.03028    40278.431    740.22151     117.8194 0.0034601686 
        46.5    511.96754    40278.431    740.22151    119.18965 0.0034627719 
          47    496.28319    40278.431    740.22151    120.58877 0.0034661495 
        47.5    495.76178    40278.431    740.22151    122.07933 0.0034720568 
          48     502.2459    40278.431    740.22151    123.26617 0.0034692928 
        48.5    502.56488    40278.431    740.22151    124.57935 0.0034701051 
          49    496.42204    40278.431    740.22151    125.73628 0.0034665928 
        49.5    498.26553    40278.431    740.22151    127.04721 0.0034673543 
          50    488.05056    40278.431    740.22151    128.31114 0.0034668309 
Loop time of 73.3145 on 8 procs for 50000 steps with 2000 atoms

Performance: 58.924 ns/day, 0.407 hours/ns, 681.994 timesteps/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.463     | 64.507     | 67.227     |  17.6 | 87.99
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.226      | 6.9267     | 8.9273     |  51.9 |  9.45
Output  | 0.0029669  | 0.0031852  | 0.0039983  |   0.6 |  0.00
Modify  | 0.7719     | 0.79656    | 0.86018    |   3.0 |  1.09
Other   |            | 1.081      |            |       |  1.47

Nlocal:    250 ave 253 max 246 min
Histogram: 1 1 0 0 2 0 0 1 1 2
Nghost:    1067 ave 1071 max 1064 min
Histogram: 2 1 1 0 0 2 0 0 1 1
Neighs:    0 ave 0 max 0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:  8707.75 ave 8823 max 8545 min
Histogram: 1 0 1 0 1 1 0 1 1 2

Total # of neighbors = 69662
Ave neighs/atom = 34.831
Neighbor list builds = 0
Dangerous builds = 0
print ${flux} file flux.dat
print 0.00346683092383822 file flux.dat
0.00346683092383822


###write_data snap/data.${N_steps}


####dump dump1 all custom ${snap_save} snap/snap.*.lammps id type x y z



###-------------------SOME INFO ON VARIOUS FIXES---------------------------

#### CONSTRUCT A TEMPERATURE PROFILE
#### THESE BINS ARE NOT RELATED TO thermal/conductivity Bins
####  bin/1d args = dim origin delta
####    dim = x or y or z
####    origin = lower or center or upper or coordinate value (distance units)
####    delta = thickness of spatial bins in dim (distance units)



####fix ID group-ID ave/chunk Nevery Nrepeat Nfreq chunkID value1 value2 ... keyword args ...
####ID, group-ID are documented in fix command
####ave/chunk = style name of this fix command
####Nevery = use input values every this many timesteps
####Nrepeat = # of times to use input values for calculating averages
####Nfreq = calculate averages every this many timesteps
####chunkID = ID of compute chunk/atom command
####one or more input values can be listed
####value = vx, vy, vz, fx, fy, fz, density/mass, density/number, temp, c_ID, c_ID[I], f_ID, f_ID[I], v_name

####For example, if Nevery=2, Nrepeat=6, and Nfreq=100, then values on timesteps 90,92,94,96,98,100 will be used to compute the final aver
###age on timestep 100. Similarly for timesteps 190,192,194,196,198,200 on timestep 200, etc. If Nrepeat=1 and Nfreq = 100, then no time a
###veraging is done; values are simply generated on timesteps 100,200,etc.





####fix ID group-ID thermal/conductivity N edim Nbin keyword value ...
####ID, group-ID are documented in fix command
####thermal/conductivity = style name of this fix command
####N = perform kinetic energy exchange every N steps
####edim = x or y or z = direction of kinetic energy transfer
####Nbin = # of layers in edim direction (must be even number)
####zero or more keyword/value pairs may be appended
####keyword = swap
####swap value = Nswap = number of swaps to perform every N steps


Total wall time: 0:01:45
